<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-27 Sat 00:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Wavecar.hpp</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Alejandro Gallo" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Wavecar.hpp</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org060ecab">Wavecar.hpp</a>
<ul>
<li><a href="#orga08e4db">Introduction</a></li>
<li><a href="#org3818a65">Header</a></li>
<li><a href="#org32d1ba3">Main types</a></li>
<li><a href="#org85982a8">Mathematical functions</a>
<ul>
<li><a href="#orgf1333ef">Products</a></li>
<li><a href="#org75f1a29">Cell volume</a></li>
<li><a href="#orgf19faed">Reciprocal cell</a></li>
</ul>
</li>
<li><a href="#org4f58d0c"><code>WAVECAR</code> parsing</a>
<ul>
<li><a href="#orgfff8a3c">Understanding the code</a></li>
<li><a href="#orgdfa1472">Wave descriptor</a></li>
<li><a href="#org497fbf2">Header</a></li>
<li><a href="#orgdf5894a">The whole <code>WAVECAR</code></a></li>
</ul>
</li>
<li><a href="#org26d6f13">Main function</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org060ecab" class="outline-2">
<h2 id="org060ecab">Wavecar.hpp</h2>
<div class="outline-text-2" id="text-org060ecab">
</div>



<div id="outline-container-orga08e4db" class="outline-3">
<h3 id="orga08e4db">Introduction</h3>
<div class="outline-text-3" id="text-orga08e4db">
<p>
This package implements a C++11 header-only library
for reading <code>WAVECAR</code> files in the <code>VASP5</code> format.
</p>

<p>
It is written as a literate program <a class='org-ref-reference' href="#LiteratePrograKnuth1984">LiteratePrograKnuth1984</a>,
so we will try to keep the documentation and the code in the same place.
</p>

<p>
As a convenience you can find the header file in the <code>include</code> directory.
</p>
</div>
</div>

<div id="outline-container-org3818a65" class="outline-3">
<h3 id="org3818a65">Header</h3>
<div class="outline-text-3" id="text-org3818a65">
<p>
We will only need libraries available in the standard library:
</p>

<div class="org-src-container">
<pre class="src src-c++"><span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">iostream</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">fstream</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">map</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">array</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">assert.h</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">string</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">numeric</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">algorithm</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">vector</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">math.h</span><span style="color: #145c33;">&gt;</span>
<span style="color: #a0132f;">#include</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">&lt;</span><span style="color: #2544bb;">complex</span><span style="color: #145c33;">&gt;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org32d1ba3" class="outline-3">
<h3 id="org32d1ba3">Main types</h3>
<div class="outline-text-3" id="text-org32d1ba3">
<p>
We define the main structure for the WAVECAR header,
</p>

<div class="org-src-container">
<pre class="src src-c++"><span style="color: #5317ac;">using</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">array</span><span style="color: #145c33;">&lt;</span><span style="color: #8f0075;">double</span>,<span style="color: #2f4f4f;"> </span>3<span style="color: #145c33;">&gt;</span>;

<span style="color: #5317ac;">struct</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">array</span><span style="color: #5317ac;">&lt;</span><span style="color: #8f0075;">CellVector</span>,<span style="color: #2f4f4f;"> </span>3<span style="color: #5317ac;">&gt;</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">basis</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">volume</span>;
<span style="color: #145c33;">}</span>;

<span style="color: #5317ac;">struct</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">WavecarHeader</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">recordLength</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">nSpin</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">version</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">nKpoints</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">nBands</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">encut</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">eFermi</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">nPlaneWaves</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">real</span>,<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">reciprocal</span>;
<span style="color: #145c33;">}</span>;

<span style="color: #5317ac;">using</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Band</span><span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">vector</span><span style="color: #145c33;">&lt;</span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">complex</span><span style="color: #5317ac;">&lt;</span><span style="color: #8f0075;">double</span><span style="color: #5317ac;">&gt;</span><span style="color: #145c33;">&gt;</span>;
<span style="color: #5317ac;">using</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">KBand</span><span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">map</span><span style="color: #145c33;">&lt;</span><span style="color: #8f0075;">CellVector</span>,<span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Band</span><span style="color: #145c33;">&gt;</span>;

<span style="color: #5317ac;">struct</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">WaveDescriptor</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">vector</span><span style="color: #5317ac;">&lt;</span><span style="color: #8f0075;">KBand</span><span style="color: #5317ac;">&gt;</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">bands</span>;
<span style="color: #145c33;">}</span>;

<span style="color: #5317ac;">struct</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Wavecar</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">WavecarHeader</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">header</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">WaveDescriptor</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">descriptor</span>;
<span style="color: #145c33;">}</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org85982a8" class="outline-3">
<h3 id="org85982a8">Mathematical functions</h3>
<div class="outline-text-3" id="text-org85982a8">
</div>
<div id="outline-container-orgf1333ef" class="outline-4">
<h4 id="orgf1333ef">Products</h4>
<div class="outline-text-4" id="text-orgf1333ef">
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">crossProduct</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">a</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">b</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span>
<span style="color: #2f4f4f;">    </span><span style="color: #5317ac;">{</span><span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>-<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span>
<span style="color: #2f4f4f;">    </span>,<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>-<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span>
<span style="color: #2f4f4f;">    </span>,<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>-<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span>
<span style="color: #2f4f4f;">    </span><span style="color: #5317ac;">}</span>;
<span style="color: #145c33;">}</span>

<span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">dotProduct</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">a</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">b</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::inner_product<span style="color: #5317ac;">(</span>a.begin<span style="color: #005a5f;">()</span>,<span style="color: #2f4f4f;"> </span>a.end<span style="color: #005a5f;">()</span>,<span style="color: #2f4f4f;"> </span>b.begin<span style="color: #005a5f;">()</span>,<span style="color: #2f4f4f;"> </span>0.0<span style="color: #5317ac;">)</span>;
<span style="color: #145c33;">}</span>

<span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">norm</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">a</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::sqrt<span style="color: #5317ac;">(</span>dotProduct<span style="color: #005a5f;">(</span>a,<span style="color: #2f4f4f;"> </span>a<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #145c33;">}</span>

<span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">angleBetween</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">a</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">b</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::acos<span style="color: #5317ac;">(</span>dotProduct<span style="color: #005a5f;">(</span>a,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>/<span style="color: #2f4f4f;"> </span>norm<span style="color: #005a5f;">(</span>a<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>/<span style="color: #2f4f4f;"> </span>norm<span style="color: #005a5f;">(</span>b<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org75f1a29" class="outline-4">
<h4 id="org75f1a29">Cell volume</h4>
<div class="outline-text-4" id="text-org75f1a29">
<p>
We can use the products to calculate the cell volume given by a basis
</p>
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">cellVolume</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">c</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span>
<span style="color: #2f4f4f;">    </span>dotProduct<span style="color: #5317ac;">(</span><span style="color: #2f4f4f;"> </span>c.basis<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span>
<span style="color: #2f4f4f;">              </span>,<span style="color: #2f4f4f;"> </span>crossProduct<span style="color: #005a5f;">(</span><span style="color: #2f4f4f;"> </span>c.basis<span style="color: #863927;">[</span>1<span style="color: #863927;">]</span>
<span style="color: #2f4f4f;">                            </span>,<span style="color: #2f4f4f;"> </span>c.basis<span style="color: #863927;">[</span>2<span style="color: #863927;">]</span>
<span style="color: #2f4f4f;">                            </span><span style="color: #005a5f;">)</span>
<span style="color: #2f4f4f;">              </span><span style="color: #5317ac;">)</span>;
<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf19faed" class="outline-4">
<h4 id="orgf19faed">Reciprocal cell</h4>
<div class="outline-text-4" id="text-orgf19faed">
<p>
Here we calculate the reciprocal cell of a given cell
</p>
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">reciprocalCell</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">c</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">Cell</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">r</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">i</span>=0;<span style="color: #2f4f4f;"> </span>i&lt;3;<span style="color: #2f4f4f;"> </span>i++<span style="color: #5317ac;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>
<span style="color: #2f4f4f;">    </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">itB</span><span style="color: #005a5f;">(</span>r.basis<span style="color: #863927;">[</span>i<span style="color: #863927;">]</span>.begin<span style="color: #863927;">()</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">    </span>r.basis<span style="color: #005a5f;">[</span>i<span style="color: #005a5f;">]</span><span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>crossProduct<span style="color: #005a5f;">(</span><span style="color: #2f4f4f;"> </span>c.basis<span style="color: #863927;">[</span><span style="color: #0000c0;">(</span>i+1<span style="color: #0000c0;">)</span><span style="color: #2f4f4f;"> </span>%<span style="color: #2f4f4f;"> </span>3<span style="color: #863927;">]</span>
<span style="color: #2f4f4f;">                             </span>,<span style="color: #2f4f4f;"> </span>c.basis<span style="color: #863927;">[</span><span style="color: #0000c0;">(</span>i+2<span style="color: #0000c0;">)</span><span style="color: #2f4f4f;"> </span>%<span style="color: #2f4f4f;"> </span>3<span style="color: #863927;">]</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">    </span><span style="color: #0000c0;">std</span>::transform<span style="color: #005a5f;">(</span><span style="color: #2f4f4f;"> </span>itB,<span style="color: #2f4f4f;"> </span>itB<span style="color: #2f4f4f;"> </span>+<span style="color: #2f4f4f;"> </span>3,<span style="color: #2f4f4f;"> </span>itB
<span style="color: #2f4f4f;">                  </span>,<span style="color: #2f4f4f;"> </span><span style="color: #863927;">[</span>&amp;<span style="color: #00538b;">c</span><span style="color: #863927;">](</span><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">i</span><span style="color: #863927;">){</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span>i*2*M_PI/c.volume;<span style="color: #2f4f4f;"> </span><span style="color: #863927;">}</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">}</span>
<span style="color: #2f4f4f;">  </span>r.volume<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>cellVolume<span style="color: #5317ac;">(</span>r<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span>r;
<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4f58d0c" class="outline-3">
<h3 id="org4f58d0c"><code>WAVECAR</code> parsing</h3>
<div class="outline-text-3" id="text-org4f58d0c">
</div>
<div id="outline-container-orgfff8a3c" class="outline-4">
<h4 id="orgfff8a3c">Understanding the code</h4>
<div class="outline-text-4" id="text-orgfff8a3c">
<p>
It can be quite challenging sometimes to understand binary formats
coming from Fortran, or binary formats in general. It is quite instructive
to peek into the binary structure of the files and try to
backwards engineer the main structure of the file.
</p>

<p>
Here is an excerpt of a hexdump of a typical <code>VASP5</code> format <code>WAVECAR</code> file:
</p>

<div class="figure">
<pre class="example">
                  BYTES      
 ADDRESS  1 2  3 4  4 6  7 8  | Comments
==============================|=========
00000000: 0000 0000 0018 d940 | Fortran record length
00000008: 0000 0000 0000 f03f | number of spin channels
00000010: 0000 0000 8006 ea40 | format version (RTAG)
00000018: 0000 0000 0000 0000 |
*                               (zero padding)
00006460: 0000 0000 0000 f03f | Number of k-points
00006468: 0000 0000 0020 b940 | Number of bands
00006470: 0000 0000 00e0 8540 | ENCUT
00006478: ba49 0c02 2b07 1140 | a[1,1] (lattice vectors)
00006480: ba49 0c02 2b07 1140 | a[1,2]
00006488: 0000 0000 0000 0000 | a[1,3]
00006490: 0000 0000 0000 0000 | a[2,1]
00006498: ba49 0c02 2b07 1140 | a[2,2]
000064a0: ba49 0c02 2b07 1140 | a[2,3]
000064a8: ba49 0c02 2b07 1140 | a[3,1]
000064b0: 0000 0000 0000 0000 | a[3,2]
000064b8: ba49 0c02 2b07 1140 | a[3,3]
000064c0: 1a6f 1d53 35e9 0540 | fermi energy
000064c8: 0000 0000 0000 0000 |
*                               (zero padding)
0000c8c0: 0000 0000 0018 a940 | number of plane waves
0000c8c8: 0000 0000 0000 0000 | kpoint[0]  \
0000c8d0: 0000 0000 0000 0000 | kpoint[1]   &gt; Gamma point
0000c8d8: 0000 0000 0000 0000 | kpoint[2]  /
0000c8e0: f1e1 932b 1cee 56c0 | energy-real     x
0000c8e8: 0000 0000 0000 0000 | energy-complex  0
0000c8f0: 0000 0000 0000 f03f | occupation      1
</pre>

</div>

<p>
Here there are a couple of things we should remark,
</p>
<ul class="org-ul">
<li><code>VASP5</code> format writes out everything using floating point numbers,
even quantities that ought to be integers, this is done so that the
binary format is compatible throughout machines (and most programming
languages) since they follow IEEE standards.</li>
<li>Fortran can use an offset to read different parts of a file
separated in records. The first quantity we get in the <code>WAVECAR</code>
is this record length. In this particular case it is equal
to <code>25696</code> or <code>0x6460</code> in hexadecimal notation.
Notice that this is equal the address where the <code>WAVECAR</code>
header begins by providing the number of \( k \)-points.</li>
<li>The second time this record length arises, is when
the first chunk of data for the wavefunction arises, i.e.
<code>2*25696 = 0xc8c0</code>, where we obtain for the first spin
channel and first \( k \)-point
<ul class="org-ul">
<li>the number of plane-waves</li>
<li>the real part of the eigenenergies</li>
<li>the complex part of the eigenenergies</li>
<li>the occupation numbers</li>
<li>the plane-wave coefficients.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgdfa1472" class="outline-4">
<h4 id="orgdfa1472">Wave descriptor</h4>
<div class="outline-text-4" id="text-orgdfa1472">
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">pair</span><span style="color: #145c33;">&lt;</span>CellVector,<span style="color: #2f4f4f;"> </span>Band<span style="color: #145c33;">&gt;</span>
<span style="color: #721045;">readWaveWaveDescriptor</span><span style="color: #145c33;">(</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">string</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">fileName</span>
<span style="color: #2f4f4f;">                      </span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">WavecarHeader</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">header</span>
<span style="color: #2f4f4f;">                      </span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">spinIndex</span>
<span style="color: #2f4f4f;">                      </span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">kIndex</span>
<span style="color: #2f4f4f;">                      </span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>

<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">vector</span><span style="color: #5317ac;">&lt;</span><span style="color: #8f0075;">double</span><span style="color: #5317ac;">&gt;</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">realEnergies</span><span style="color: #5317ac;">(</span>header.nBands<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span>,<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">imagEnergies</span><span style="color: #5317ac;">(</span>header.nBands<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span>,<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">occupancies</span><span style="color: #5317ac;">(</span>header.nBands<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span>;

<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">buffer</span>,<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">vbuffer</span><span style="color: #5317ac;">[</span>3<span style="color: #5317ac;">]</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">fstream</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">file</span><span style="color: #5317ac;">(</span>fileName,<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #0000c0;">ios</span>::binary<span style="color: #2f4f4f;"> </span>|<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #0000c0;">ios</span>::in<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">numberPlaneWaves</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">CellVector</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">kpoint</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">vector</span><span style="color: #5317ac;">&lt;</span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">complex</span><span style="color: #005a5f;">&lt;</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">&gt;</span><span style="color: #5317ac;">&gt;</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">C</span>;

<span style="color: #2f4f4f;">  </span>file.seekg<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span>spinIndex<span style="color: #2f4f4f;"> </span>+<span style="color: #2f4f4f;"> </span>2<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>header.recordLength<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #505050;">//</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">read</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">numberPlaneWaves</span>
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>numberPlaneWaves<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span>C.resize<span style="color: #5317ac;">(</span>header.nBands<span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>numberPlaneWaves<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;kpoint,<span style="color: #2f4f4f;"> </span>3*<span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">n</span>=0;<span style="color: #2f4f4f;"> </span>n<span style="color: #2f4f4f;"> </span>&lt;<span style="color: #2f4f4f;"> </span>header.nBands;<span style="color: #2f4f4f;"> </span>n++<span style="color: #5317ac;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>
<span style="color: #2f4f4f;">    </span>file.read<span style="color: #005a5f;">(</span><span style="color: #863927;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #863927;">)(</span>realEnergies.data<span style="color: #0000c0;">()</span><span style="color: #2f4f4f;"> </span>+<span style="color: #2f4f4f;"> </span>n<span style="color: #863927;">)</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #863927;">(</span><span style="color: #8f0075;">double</span><span style="color: #863927;">)</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">    </span>file.read<span style="color: #005a5f;">(</span><span style="color: #863927;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #863927;">)(</span>imagEnergies.data<span style="color: #0000c0;">()</span><span style="color: #2f4f4f;"> </span>+<span style="color: #2f4f4f;"> </span>n<span style="color: #863927;">)</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #863927;">(</span><span style="color: #8f0075;">double</span><span style="color: #863927;">)</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">    </span>file.read<span style="color: #005a5f;">(</span><span style="color: #863927;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #863927;">)(</span>occupancies.data<span style="color: #0000c0;">()</span><span style="color: #2f4f4f;"> </span>+<span style="color: #2f4f4f;"> </span>n<span style="color: #863927;">)</span>,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #863927;">(</span><span style="color: #8f0075;">double</span><span style="color: #863927;">)</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">}</span>

<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">n</span>=0;<span style="color: #2f4f4f;"> </span>n<span style="color: #2f4f4f;"> </span>&lt;<span style="color: #2f4f4f;"> </span>header.nBands<span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span>numberPlaneWaves;<span style="color: #2f4f4f;"> </span>n++<span style="color: #5317ac;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>
<span style="color: #2f4f4f;">    </span>file.read<span style="color: #005a5f;">(</span><span style="color: #863927;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #863927;">)</span>&amp;C<span style="color: #863927;">[</span>n<span style="color: #863927;">]</span>,<span style="color: #2f4f4f;"> </span>2*<span style="color: #5317ac;">sizeof</span><span style="color: #863927;">(</span><span style="color: #8f0075;">double</span><span style="color: #863927;">)</span><span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">}</span>

<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>kpoint,<span style="color: #2f4f4f;"> </span>C<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">}</span>;

<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org497fbf2" class="outline-4">
<h4 id="org497fbf2">Header</h4>
<div class="outline-text-4" id="text-org497fbf2">
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">WavecarHeader</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">readWavecarHeader</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">string</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">fileName</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">WavecarHeader</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">header</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">fstream</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">file</span><span style="color: #5317ac;">(</span>fileName,<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #0000c0;">ios</span>::binary<span style="color: #2f4f4f;"> </span>|<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #0000c0;">ios</span>::in<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">buffer</span>,<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">vbuffer</span><span style="color: #5317ac;">[</span>3<span style="color: #5317ac;">]</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">vector</span><span style="color: #5317ac;">&lt;</span><span style="color: #8f0075;">double</span><span style="color: #5317ac;">&gt;</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">vvbuffer</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #505050;">//</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">double</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">hbarConst</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">=</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">0.26246582250210965422;</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">//</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">1/eV</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">Ang^2</span>

<span style="color: #2f4f4f;">  </span>assert<span style="color: #5317ac;">(</span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>==<span style="color: #2f4f4f;"> </span>8<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>assert<span style="color: #5317ac;">(</span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span>header.real.basis<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>==<span style="color: #2f4f4f;"> </span>72<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>assert<span style="color: #5317ac;">(</span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span>CellVector<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span>==<span style="color: #2f4f4f;"> </span>3<span style="color: #2f4f4f;"> </span>*<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.recordLength<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.nSpin<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.version<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">if</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span>header.version<span style="color: #2f4f4f;"> </span>!=<span style="color: #2f4f4f;"> </span>53300<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span><span style="color: #5317ac;">throw</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"This</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">program</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">only</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">supports</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">VASP5</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">format</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">(RTAG:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">53300)"</span>;

<span style="color: #2f4f4f;">  </span>file.seekg<span style="color: #5317ac;">(</span>header.recordLength<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.nKpoints<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.nBands<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.encut<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>size_t<span style="color: #5317ac;">(</span>buffer<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #505050;">//</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">Setup</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">real</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">cell</span>
<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;header.real.basis,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span>header.real.basis<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.real.volume<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>cellVolume<span style="color: #5317ac;">(</span>header.real<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span>file.read<span style="color: #5317ac;">(</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">char</span>*<span style="color: #005a5f;">)</span>&amp;buffer,<span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">sizeof</span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">double</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span>header.eFermi<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>buffer;

<span style="color: #2f4f4f;">  </span><span style="color: #505050;">//</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">Setup</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">Reciprocal</span><span style="color: #2f4f4f;"> </span><span style="color: #505050;">cell</span>
<span style="color: #2f4f4f;">  </span>header.reciprocal<span style="color: #2f4f4f;"> </span>=<span style="color: #2f4f4f;"> </span>reciprocalCell<span style="color: #5317ac;">(</span>header.real<span style="color: #5317ac;">)</span>;



<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span>header;
<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf5894a" class="outline-4">
<h4 id="orgdf5894a">The whole <code>WAVECAR</code></h4>
<div class="outline-text-4" id="text-orgdf5894a">
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">Wavecar</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">readWavecar</span><span style="color: #145c33;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::<span style="color: #8f0075;">string</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">fileName</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">header</span><span style="color: #5317ac;">(</span>readWavecarHeader<span style="color: #005a5f;">(</span>fileName<span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #8f0075;">WaveDescriptor</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">descriptor</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #8f0075;">uint8_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">i</span>=0;<span style="color: #2f4f4f;"> </span>i<span style="color: #2f4f4f;"> </span>&lt;<span style="color: #2f4f4f;"> </span>header.nSpin;<span style="color: #2f4f4f;"> </span>i++<span style="color: #5317ac;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>
<span style="color: #2f4f4f;">    </span><span style="color: #8f0075;">KBand</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">band</span>;
<span style="color: #2f4f4f;">    </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #005a5f;">(</span><span style="color: #8f0075;">size_t</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">k</span>=0;<span style="color: #2f4f4f;"> </span>k<span style="color: #2f4f4f;"> </span>&lt;<span style="color: #2f4f4f;"> </span>header.nKpoints;<span style="color: #2f4f4f;"> </span>k++<span style="color: #005a5f;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #005a5f;">{</span>
<span style="color: #2f4f4f;">      </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">pair</span><span style="color: #863927;">(</span>readWaveWaveDescriptor<span style="color: #0000c0;">(</span>fileName,<span style="color: #2f4f4f;"> </span>header,<span style="color: #2f4f4f;"> </span>i,<span style="color: #2f4f4f;"> </span>k<span style="color: #0000c0;">)</span><span style="color: #863927;">)</span>;
<span style="color: #2f4f4f;">      </span>band.emplace<span style="color: #863927;">(</span>pair<span style="color: #863927;">)</span>;
<span style="color: #2f4f4f;">    </span><span style="color: #005a5f;">}</span>
<span style="color: #2f4f4f;">    </span>descriptor.bands.push_back<span style="color: #005a5f;">(</span>band<span style="color: #005a5f;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">}</span>
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">return</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">{</span>header,<span style="color: #2f4f4f;"> </span>descriptor<span style="color: #5317ac;">}</span>;

<span style="color: #145c33;">}</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org26d6f13" class="outline-3">
<h3 id="org26d6f13">Main function</h3>
<div class="outline-text-3" id="text-org26d6f13">
<div class="org-src-container">
<pre class="src src-c++"><span style="color: #8f0075;">int</span><span style="color: #2f4f4f;"> </span><span style="color: #721045;">main</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">(</span><span style="color: #8f0075;">int</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">argc</span>,<span style="color: #2f4f4f;"> </span><span style="color: #8f0075;">char</span><span style="color: #2f4f4f;"> </span>**<span style="color: #00538b;">argv</span><span style="color: #145c33;">)</span><span style="color: #2f4f4f;"> </span><span style="color: #145c33;">{</span>
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::cout<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"WAVIS"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::endl;
<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::cout<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"====="</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #0000c0;">std</span>::endl;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span><span style="color: #00538b;">wavecar</span><span style="color: #5317ac;">(</span>readWavecar<span style="color: #005a5f;">(</span><span style="color: #2544bb;">"WAVECAR"</span><span style="color: #005a5f;">)</span><span style="color: #5317ac;">)</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">auto</span>&amp;<span style="color: #2f4f4f;"> </span><span style="color: #00538b;">header</span><span style="color: #5317ac;">(</span>wavecar.header<span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::cout<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"recordLength:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.recordLength<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"nSpin:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.nSpin<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"version:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.version<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"nKpoints:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.nKpoints<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"nBands:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.nBands<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"encut:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.encut<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"eFermi:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.eFermi<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"volume:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"</span><span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span>header.real.volume<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>
<span style="color: #2f4f4f;">            </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"\n"</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::cout<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"Lattice</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">vectors:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">\n"</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">b</span>:<span style="color: #2f4f4f;"> </span>header.real.basis<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span>printf<span style="color: #5317ac;">(</span><span style="color: #2544bb;">"-</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f\n"</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span><span style="color: #5317ac;">)</span>;

<span style="color: #2f4f4f;">  </span><span style="color: #0000c0;">std</span>::cout<span style="color: #2f4f4f;"> </span>&lt;&lt;<span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">"Reciprocal</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">vectors:</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">\n"</span>;
<span style="color: #2f4f4f;">  </span><span style="color: #5317ac;">for</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">(</span><span style="color: #5317ac;">const</span><span style="color: #2f4f4f;"> </span><span style="color: #5317ac;">auto</span><span style="color: #2f4f4f;"> </span>&amp;<span style="color: #00538b;">b</span>:<span style="color: #2f4f4f;"> </span>header.reciprocal.basis<span style="color: #5317ac;">)</span>
<span style="color: #2f4f4f;">    </span>printf<span style="color: #5317ac;">(</span><span style="color: #2544bb;">"-</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f</span><span style="color: #2f4f4f;"> </span><span style="color: #2544bb;">%f\n"</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>0<span style="color: #005a5f;">]</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>1<span style="color: #005a5f;">]</span>,<span style="color: #2f4f4f;"> </span>b<span style="color: #005a5f;">[</span>2<span style="color: #005a5f;">]</span><span style="color: #5317ac;">)</span>;

<span style="color: #145c33;">}</span>
</pre>
</div>






<p>

<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="LiteratePrograKnuth1984">[LiteratePrograKnuth1984]</a> <a name="LiteratePrograKnuth1984"></a>Knuth, Literate Programming, <i>The Computer Journal</i>, <b>27</b>, 97-111 (1984). <a href="http://dx.doi.org/10.1093/comjnl/27.2.97">link</a>. <a href="http://dx.doi.org/10.1093/comjnl/27.2.97">doi</a>.</li>
</ul>
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alejandro Gallo</p>
<p class="date">Created: 2021-02-27 Sat 00:12</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
